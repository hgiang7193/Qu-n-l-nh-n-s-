@model IEnumerable<HRManagementSystem.Web.Models.ProjectAssignment>

@{
    ViewData["Title"] = "Gán nhân viên vào dự án";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900">Gán nhân viên vào dự án</h1>
        <p class="mt-2 text-gray-600">Quản lý các nhân viên được gán vào dự án: <span class="font-semibold">@ViewBag.Project.Name</span></p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Current assignments -->
        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">Nhân viên hiện tại trong dự án</h2>
            
            @if (Model.Any())
            {
                <div class="space-y-3">
                    @foreach (var assignment in Model)
                    {
                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-medium mr-3">
                                    @assignment.Employee.FullName.Substring(0, 1).ToUpper()
                                </div>
                                <div>
                                    <div class="font-medium text-gray-900">@assignment.Employee.FullName</div>
                                    <div class="text-sm text-gray-500">@assignment.Role</div>
                                </div>
                            </div>
                            <form asp-action="RemoveAssignment" asp-route-id="@assignment.Id" method="post" style="display:inline;">
                                <button type="submit" class="btn btn-outline-danger px-3 py-1 text-sm" onclick="return confirm('Bạn có chắc chắn muốn gỡ nhân viên này khỏi dự án?');">
                                    <i class="fas fa-times"></i>
                                </button>
                            </form>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-users text-3xl mb-2"></i>
                    <p>Chưa có nhân viên nào được gán vào dự án này</p>
                </div>
            }
        </div>
        
        <!-- Available employees to assign -->
        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">Gán nhân viên mới</h2>
            
            <form asp-action="AssignEmployee" method="post" class="space-y-4">
                <input type="hidden" name="projectId" value="@ViewBag.Project.Id" />
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Chọn nhân viên</label>
                    <select name="employeeId" class="form-control w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="">-- Chọn nhân viên --</option>
                        @foreach (var employee in ViewBag.AvailableEmployees as IEnumerable<HRManagementSystem.Web.Models.User>)
                        {
                            <option value="@employee.Id">@employee.FullName (@employee.Email)</option>
                        }
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Vai trò trong dự án</label>
                    <input type="text" name="role" value="Member" class="form-control w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required />
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ngày bắt đầu</label>
                    <input type="date" name="startDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" class="form-control w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required />
                </div>
                
                <div class="pt-4">
                    <button type="submit" class="btn btn-primary px-6 py-2 rounded-lg flex items-center">
                        <i class="fas fa-user-plus mr-2"></i> Gán nhân viên
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div class="mt-6">
        <a asp-action="Index" class="btn btn-secondary px-6 py-2 rounded-lg flex items-center w-fit">
            <i class="fas fa-arrow-left mr-2"></i> Quay lại danh sách dự án
        </a>
    </div>
</div>